{"Comment": "A description of my state machine", "StartAt": "Choice", "States": {"Choice": {"Type": "Choice", "Choices": [{"Variable": "$.detail.object.key", "StringMatches": "vnfd/*", "Next": "CreateSolFunctionPackage"}, {"Variable": "$.detail.object.key", "StringMatches": "nsd/*", "Next": "CreateSolNetworkPackage"}]}, "CreateSolNetworkPackage": {"Type": "Task", "Next": "UploadNSDFile", "Parameters": {}, "Resource": "arn:aws:states:::aws-sdk:tnb:createSolNetworkPackage", "ResultPath": "$.metadata"}, "UploadNSDFile": {"Type": "Task", "Resource": "arn:aws:states:::lambda:invoke", "Parameters": {"Payload.$": "$", "FunctionName": "${Token[TOKEN.103]}"}, "Retry": [{"ErrorEquals": ["Lambda.ServiceException", "Lambda.AWSLambdaException", "Lambda.SdkClientException", "Lambda.TooManyRequestsException"], "IntervalSeconds": 1, "MaxAttempts": 3, "BackoffRate": 2}], "Next": "DynamoDB UploadNSD", "ResultPath": "$.metadata", "Catch": [{"ErrorEquals": ["States.ALL"], "ResultPath": null, "Next": "DynamoDB UploadNSD"}]}, "DynamoDB UploadNSD": {"Type": "Task", "Resource": "arn:aws:states:::dynamodb:putItem", "Parameters": {"TableName": "${Token[TOKEN.35]}", "Item": {"key": {"S.$": "$.detail.object.key"}, "np": {"S.$": "$.metadata.Payload.Id"}}}, "Next": "ListSolNetworkPackages"}, "ListSolNetworkPackages": {"Type": "Task", "Parameters": {}, "Resource": "arn:aws:states:::aws-sdk:tnb:listSolNetworkPackages", "Next": "Update fps"}, "Update fps": {"Type": "Task", "Resource": "arn:aws:states:::lambda:invoke", "OutputPath": "$.Payload", "Parameters": {"Payload.$": "$", "FunctionName": "${Token[TOKEN.145]}"}, "Retry": [{"ErrorEquals": ["Lambda.ServiceException", "Lambda.AWSLambdaException", "Lambda.SdkClientException", "Lambda.TooManyRequestsException"], "IntervalSeconds": 1, "MaxAttempts": 3, "BackoffRate": 2}], "End": true}, "CreateSolFunctionPackage": {"Type": "Task", "Parameters": {}, "Resource": "arn:aws:states:::aws-sdk:tnb:createSolFunctionPackage", "ResultPath": "$.metadata", "Next": "Upload CSAR File"}, "Upload CSAR File": {"Type": "Task", "Resource": "arn:aws:states:::lambda:invoke", "Parameters": {"Payload.$": "$", "FunctionName": "${Token[TOKEN.89]}"}, "Retry": [{"ErrorEquals": ["Lambda.ServiceException", "Lambda.AWSLambdaException", "Lambda.SdkClientException", "Lambda.TooManyRequestsException"], "IntervalSeconds": 1, "MaxAttempts": 3, "BackoffRate": 2}], "Next": "DynamoDB UploadVNFD", "ResultPath": "$.metadata2"}, "DynamoDB UploadVNFD": {"Type": "Task", "Resource": "arn:aws:states:::dynamodb:putItem", "Parameters": {"TableName": "${Token[TOKEN.35]}", "Item": {"key": {"S.$": "$.detail.object.key"}, "fp": {"S.$": "$.metadata.Id"}}}, "End": true}}}